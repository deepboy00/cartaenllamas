<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>I love you</title>
  <link rel="stylesheet" href="./style.css">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600&family=Great+Vibes&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
</head>
<body>
<!-- partial:index.partial.html -->
<div class="page">
  <div class="header-container">
    <div class="header" id="typed-header"></div>
  </div>
  <div class="content">
    <p id="typed-text"></p>
  </div>
  <div class="proposal" id="proposal">
    <h2>¬øQuieres ser mi novia? ‚ù§Ô∏è</h2>
    <div class="buttons">
      <button class="btn yes" onclick="respuesta('si')">S√≠ üíñ</button>
      <button class="btn no" onclick="respuesta('no')">No üíî</button>
    </div>
  </div>

</div>

<!--
<div class="reloj-amor" id="relojAmor"></div>
-->

<script>
  const header = document.getElementById('typed-header');
  const body = document.getElementById('typed-text');
  const contenedor = document.getElementById('relojAmor');

  const headerText = "De Angelo para mi chica linda‚ù§Ô∏è‚Äçüî•";
  const bodyText = `Hace un a√±o como hoy(y 15 dias xdxd), dije que sentia algo por ti entonces para ese tiempo no sabia que era pero con el tiempo me di cuenta que me gustabas y cada dia que pasaba hacias que me enamore mas de ti, pienso todos los dias en ti, y como no hacerlo con esos ojos que dan color a mi vida, esa sonrisa que alegra mis dias y carita tan linda que tienes. Te ganaste mi coraz√≥n, conquistaste mi mente(dificil), hiciste que mi alma siempre quiera estar con la tuya, y no tengo duda que mi piel quiera rozar la tuya. Paso el tiempo que yo queria que pasara para conocerte mas pero nose si fue lo correcto... pero bueno ya paso y estoy dispuesto a quererte con todo mi ser y demotrar lo mucho que me importas, lo mucho que te aprecio, y sobre todo hacer que lo nuestro funcione. Entonces le√≠ San Marcos 10:9 y entend√≠ "No permitan que nadie separe lo que Dios unio", y quiero que se cumpla <3.`;

  // Cambi√© la velocidad de escritura de 60 a 10 para hacerlo m√°s r√°pido
  function typeWriter(el, text, i, speed, done) {
    if (i < text.length) {
      el.innerHTML += text.charAt(i) === '\n' ? '<br>' : text.charAt(i);
      setTimeout(() => typeWriter(el, text, i + 1, speed, done), speed);
    } else if (done) {
      done();
    }
  }

  function calcularTextoReloj() {
    const fechaInicio = new Date("2024-06-10T00:00:00");
    const ahora = new Date();
    const diferencia = ahora - fechaInicio;

    const totalSegundos = Math.floor(diferencia / 1000);
    const dias = Math.floor(totalSegundos / (3600 * 24));
    const horas = Math.floor((totalSegundos % (3600 * 24)) / 3600);
    const minutos = Math.floor((totalSegundos % 3600) / 60);
    const segundos = totalSegundos % 60;

    return `Mi amor por ti comenz√≥ hace...\n${dias} d√≠as ${horas} horas ${minutos} minutos ${segundos} segundos`;
  }

  function escribirComoMaquina(texto, elemento, velocidad = 60, callback) {  // Velocidad ajustada a 10
    let i = 0;
    elemento.innerHTML = "";
    const intervalo = setInterval(() => {
      elemento.innerHTML += texto.charAt(i);
      i++;
      if (i >= texto.length) {
        clearInterval(intervalo);
        if (callback) callback();
      }
    }, velocidad);  // Aseg√∫rate de que esta velocidad sea m√°s baja
  }

  function actualizarTiempo() {
    contenedor.innerHTML = calcularTextoReloj();
  }

  function iniciarReloj() {
    contenedor.style.opacity = 1;
    const textoInicial = calcularTextoReloj();
    escribirComoMaquina(textoInicial, contenedor, 60, () => {  // Velocidad ajustada a 10
      setInterval(actualizarTiempo, 1000);
    });
  }

  // Bloqueo de scroll al cargar la p√°gina
  function bloquearScroll() {
    document.body.style.overflow = 'hidden';  // Bloquea el scroll
  }

  // Desbloqueo del scroll despu√©s de 3 segundos
  function desbloquearScroll() {
    setTimeout(() => {
      typeWriter(header, headerText, 0, 60, () => {  // Velocidad ajustada a 10
        header.classList.remove("typing");
        typeWriter(body, bodyText, 0, 40, () => {  // Velocidad ajustada a 10
          setTimeout(() => {
            mostrarPregunta();
          }, 1500);
          
          
        });
      });
    }, 3000); // Despu√©s de 3 segundos, empieza a escribir el texto
  }

  function mostrarPregunta() {
    const proposal = document.getElementById("proposal");
    proposal.style.opacity = 1;
    proposal.style.pointerEvents = "auto";
    proposal.style.transform = "translateY(0)";
  }

  // Inicia la animaci√≥n autom√°ticamente y hace el scroll durante 3 segundos
  function iniciarAnimacion() {
    window.scrollTo(0, 0); // Emula el desplazamiento hacia arriba
    setTimeout(() => {
      // Desbloquea el scroll y empieza la escritura del texto
      desbloquearScroll();
    }, 3000);  // Simula el scroll durante 3 segundos

    // Muestra el mensaje "Esto es para ti ‚ù§Ô∏è‚Äçüî•" durante 3 segundos
    document.querySelector(".scroll-msg > div:nth-child(1)").innerText = "Esto es para ti ‚ù§Ô∏è‚Äçüî•";
    setTimeout(() => {
      document.querySelector(".scroll-msg > div:nth-child(1)").style.opacity = 0;
    }, 3000);

    // Inicia la animaci√≥n del fuego
    gsap.to(params, {
        fireTime: 0.63,
        duration: 3,
        delay: 3, // Espera 3 segundos antes de iniciar el fuego
    });
  }

  // Llama a la funci√≥n para iniciar la animaci√≥n al cargar la p√°gina
  window.onload = () => {
    bloquearScroll(); // Bloquea el scroll al principio
    iniciarAnimacion();
  };
</script>

<canvas id="fire-overlay"></canvas>
<div class="scroll-msg">
    <div>Esto es para ti ‚ù§Ô∏è‚Äçüî•</div>
</div>

<script type="x-shader/x-fragment" id="vertShader">
    precision mediump float;

    varying vec2 vUv;
    attribute vec2 a_position;

    void main() {
        vUv = a_position;
        gl_Position = vec4(a_position, 0.0, 1.0);
    }
</script>

<script type="x-shader/x-fragment" id="fragShader">
    precision mediump float;

    varying vec2 vUv;
    uniform vec2 u_resolution;
    uniform float u_progress;
    uniform float u_time;

    float rand(vec2 n) {
        return fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);
    }
    float noise(vec2 n) {
        const vec2 d = vec2(0., 1.);
        vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));
        return mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);
    }
    float fbm(vec2 n) {
        float total = 0.0, amplitude = .4;
        for (int i = 0; i < 4; i++) {
            total += noise(n) * amplitude;
            n += n;
            amplitude *= 0.6;
        }
        return total;
    }

    void main() {
        vec2 uv = vUv;
        uv.x *= min(1., u_resolution.x / u_resolution.y);
        uv.y *= min(1., u_resolution.y / u_resolution.x);

        float t = u_progress;
        vec3 color = vec3(1., 1., .95);

        float main_noise = 1. - fbm(.75 * uv + 10. - vec2(.3, .9 * t));

        float paper_darkness = smoothstep(main_noise - .1, main_noise, t);
        color -= vec3(.99, .95, .99) * paper_darkness;

        vec3 fire_color = fbm(6. * uv - vec2(0., .005 * u_time)) * vec3(6., 1.4, .0);
        float show_fire = smoothstep(.4, .9, fbm(10. * uv + 2. - vec2(0., .005 * u_time)));
        show_fire += smoothstep(.7, .8, fbm(.5 * uv + 5. - vec2(0., .001 * u_time)));

        float fire_border = .02 * show_fire;
        float fire_edge = smoothstep(main_noise - fire_border, main_noise - .5 * fire_border, t);
        fire_edge *= (1. - smoothstep(main_noise - .5 * fire_border, main_noise, t));
        color += fire_color * fire_edge;

        float opacity = 1. - smoothstep(main_noise - .0005, main_noise, t);

        gl_FragColor = vec4(color, opacity);
    }
</script>

<!-- partial -->
<script src='https://unpkg.com/gsap@3/dist/gsap.min.js'></script>
<script src='https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js'></script><script  src="./script.js"></script>

</body>
</html>
